

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DataSet &mdash; reciprocalspaceship 0.8.6 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx-dropdown.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.min.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DataSeries" href="reciprocalspaceship.DataSeries.html" />
    <link rel="prev" title="API Reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> reciprocalspaceship
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#reflection-data">Reflection Data</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">DataSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="reciprocalspaceship.DataSeries.html">DataSeries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-output">Input/Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#algorithms">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#helpful-functions">Helpful Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#commandline-tools">Commandline Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">For Developers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">reciprocalspaceship</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
      <li>DataSet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/autoapi/reciprocalspaceship.DataSet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="dataset">
<h1>DataSet<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="reciprocalspaceship.DataSet">
<em class="property">class </em><code class="sig-prename descclassname">reciprocalspaceship.</code><code class="sig-name descname">DataSet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">columns</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">spacegroup</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cell</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">merged</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L17-L694"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.core.frame.DataFrame</span></code></p>
<p>Representation of a crystallographic dataset.</p>
<p>A DataSet object provides a tabular representation of reflection data.
Reflections are conventionally indexed by Miller indices (rows), but
can also be indexed by additional metadata. Per-reflection data can be
stored as columns. For additional information about inherited methods
and attributes, please see the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas.DataFrame documentation</a>.</p>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.cell" title="reciprocalspaceship.DataSet.cell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell</span></code></a></p></td>
<td><p>Unit cell parameters (a, b, c, alpha, beta, gamma)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.merged" title="reciprocalspaceship.DataSet.merged"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merged</span></code></a></p></td>
<td><p>Whether DataSet contains merged reflection data (boolean)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.spacegroup" title="reciprocalspaceship.DataSet.spacegroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spacegroup</span></code></a></p></td>
<td><p>Crystallographic space group</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>([data, index, columns, dtype, …])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.apply_symop" title="reciprocalspaceship.DataSet.apply_symop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_symop</span></code></a>(symop[, inplace])</p></td>
<td><p>Apply symmetry operation to all reflections in DataSet object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.canonicalize_phases" title="reciprocalspaceship.DataSet.canonicalize_phases"><code class="xref py py-obj docutils literal notranslate"><span class="pre">canonicalize_phases</span></code></a>([inplace])</p></td>
<td><p>Canonicalize columns with phase data to fall in the interval between -180 and 180 degrees.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.compute_dHKL" title="reciprocalspaceship.DataSet.compute_dHKL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dHKL</span></code></a>([inplace])</p></td>
<td><p>Compute the real space lattice plane spacing, d, associated with the HKL indices in the object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.from_gemmi" title="reciprocalspaceship.DataSet.from_gemmi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_gemmi</span></code></a>(gemmiMtz)</p></td>
<td><p>Creates DataSet object from gemmi.Mtz object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_hkls" title="reciprocalspaceship.DataSet.get_hkls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hkls</span></code></a>()</p></td>
<td><p>Get the Miller indices in the DataSet as a ndarray.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_m_isym_keys" title="reciprocalspaceship.DataSet.get_m_isym_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_m_isym_keys</span></code></a>()</p></td>
<td><p>Return column labels for data with M/ISYM dtype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_phase_keys" title="reciprocalspaceship.DataSet.get_phase_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_phase_keys</span></code></a>()</p></td>
<td><p>Return column labels for data with Phase dtype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="reciprocalspaceship.DataSet.hkl_to_asu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hkl_to_asu</span></code></a>([inplace])</p></td>
<td><p>Map HKL indices to the reciprocal space asymmetric unit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="reciprocalspaceship.DataSet.hkl_to_observed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hkl_to_observed</span></code></a>([m_isym, inplace])</p></td>
<td><p>Map HKL indices to their observed index using an <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.infer_mtz_dtypes" title="reciprocalspaceship.DataSet.infer_mtz_dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">infer_mtz_dtypes</span></code></a>([inplace, index])</p></td>
<td><p>Infers MTZ dtypes from column names and underlying data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.label_centrics" title="reciprocalspaceship.DataSet.label_centrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_centrics</span></code></a>([inplace])</p></td>
<td><p>Label centric reflections in DataSet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.reset_index" title="reciprocalspaceship.DataSet.reset_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_index</span></code></a>(**kwargs)</p></td>
<td><p>Reset the index, or a level of it.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.set_index" title="reciprocalspaceship.DataSet.set_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_index</span></code></a>(keys, **kwargs)</p></td>
<td><p>Set the DataFrame index using existing columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.stack_anomalous" title="reciprocalspaceship.DataSet.stack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stack_anomalous</span></code></a>([plus_labels, minus_labels])</p></td>
<td><p>Convert data from two-column anomalous format to one-column format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_gemmi" title="reciprocalspaceship.DataSet.to_gemmi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_gemmi</span></code></a>([skip_problem_mtztypes])</p></td>
<td><p>Creates gemmi.Mtz object from DataSet object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="reciprocalspaceship.DataSet.unstack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unstack_anomalous</span></code></a>([columns, suffixes])</p></td>
<td><p>Convert data from one-column format to two-column anomalous format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.write_mtz" title="reciprocalspaceship.DataSet.write_mtz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_mtz</span></code></a>(mtzfile[, skip_problem_mtztypes])</p></td>
<td><p>Write DataSet to MTZ file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="reciprocalspaceship.DataSet.apply_symop">
<code class="sig-name descname">apply_symop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symop</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L230-L264"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.apply_symop" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply symmetry operation to all reflections in DataSet object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symop</strong> (<em>gemmi.Op</em>) – Gemmi symmetry operation</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to return a new DataFrame or make the change in place</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.canonicalize_phases">
<code class="sig-name descname">canonicalize_phases</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L671-L694"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.canonicalize_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonicalize columns with phase data to fall in the interval between
-180 and 180 degrees. This method will modify the values within any
column composed of data with the PhaseDtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.cell">
<em class="property">property </em><code class="sig-name descname">cell</code><a class="headerlink" href="#reciprocalspaceship.DataSet.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit cell parameters (a, b, c, alpha, beta, gamma)</p>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.compute_dHKL">
<code class="sig-name descname">compute_dHKL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L340-L357"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.compute_dHKL" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the real space lattice plane spacing, d, associated with
the HKL indices in the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or return a copy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.from_gemmi">
<em class="property">classmethod </em><code class="sig-name descname">from_gemmi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gemmiMtz</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L136-L158"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.from_gemmi" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates DataSet object from gemmi.Mtz object.</p>
<p>If the gemmi.Mtz object contains an M/ISYM column, an unmerged
DataSet will be constructed. The Miller indices will be mapped to
their observed values, and a partiality flag will be extracted
and stored as a boolean column with the label, <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>.</p>
<p>If columns are found with the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype and are labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>
or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code>, these will be interpreted as boolean flags used to
label partial or centric reflections, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gemmiMtz</strong> (<em>gemmi.Mtz</em>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.get_hkls">
<code class="sig-name descname">get_hkls</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L266-L276"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_hkls" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Miller indices in the DataSet as a ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>hkl</strong> (<em>ndarray, shape=(n_reflections, 3)</em>) – Miller indices in DataSet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.get_m_isym_keys">
<code class="sig-name descname">get_m_isym_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L218-L228"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_m_isym_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return column labels for data with M/ISYM dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>list of strings</em>) – list of column labels with <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.get_phase_keys">
<code class="sig-name descname">get_phase_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L206-L216"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_phase_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return column labels for data with Phase dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list of strings</em>) – list of column labels with <code class="docutils literal notranslate"><span class="pre">Phase</span></code> dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.hkl_to_asu">
<code class="sig-name descname">hkl_to_asu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L538-L594"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="Permalink to this definition">¶</a></dt>
<dd><p>Map HKL indices to the reciprocal space asymmetric unit. If phases
are included in the DataSet, they will be changed according to the
phase shift associated with the necessary symmetry operation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, and a partiality flag labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>
is included in the DataSet, the partiality flag will be used to
construct a proper M/ISYM column. Both merged and unmerged DataSets
will have an M/ISYM column added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="reciprocalspaceship.DataSet.hkl_to_observed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.hkl_to_observed()</span></code></a></dt><dd><p>Opposite of DataSet.hkl_to_asu()</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.hkl_to_observed">
<code class="sig-name descname">hkl_to_observed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m_isym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L596-L669"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="Permalink to this definition">¶</a></dt>
<dd><p>Map HKL indices to their observed index using an <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column.
This method applies the symmetry operation specified by the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code>
column to each Miller index in the DataSet. If phases are included
in the DataSet, they will be changed by the phase shift associated
with the symmetry operation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column is used to
construct a partiality flag labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>. This is added to
the DataSet, and the M/ISYM column is dropped. If
<code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">True</span></code>, the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column is dropped, but
a partiality flag is not added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_isym</strong> (<em>str</em>) – Column label for M/ISYM values in DataSet. If m_isym is None
and a single M/ISYM column is present, it will automatically
be used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="reciprocalspaceship.DataSet.hkl_to_asu"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.hkl_to_asu()</span></code></a></dt><dd><p>Opposite of DataSet.hkl_to_observed()</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.infer_mtz_dtypes">
<code class="sig-name descname">infer_mtz_dtypes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L296-L338"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.infer_mtz_dtypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers MTZ dtypes from column names and underlying data. This
method iterates over each column in the DataSet and tries to infer
its proper MTZ dtype based on common MTZ naming conventions.</p>
<p>If a given column is already a MTZDtype, its type will be unchanged.
If index is True, the MTZ dtypes will be inferred for named columns
in the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the dtypes in place or to return a copy</p></li>
<li><p><strong>index</strong> (<em>bool</em>) – Infer MTZ dtypes for named column(s) in the DataSet index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="reciprocalspaceship.DataSeries.html#reciprocalspaceship.DataSeries.infer_mtz_dtype" title="reciprocalspaceship.DataSeries.infer_mtz_dtype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSeries.infer_mtz_dtype()</span></code></a></dt><dd><p>Infer MTZ dtype for DataSeries</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.label_centrics">
<code class="sig-name descname">label_centrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L278-L294"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.label_centrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Label centric reflections in DataSet. A new column of
booleans, “CENTRIC”, is added to the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or to return a copy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.merged">
<em class="property">property </em><code class="sig-name descname">merged</code><a class="headerlink" href="#reciprocalspaceship.DataSet.merged" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether DataSet contains merged reflection data (boolean)</p>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.reset_index">
<code class="sig-name descname">reset_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L112-L134"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.reset_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the index, or a level of it.</p>
<p>Reset the index of the DataFrame, and use the default one instead.
If the DataFrame has a MultiIndex, this method can remove one or more
levels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>int, str, tuple, or list, default None</em>) – Only remove the given levels from the index. Removes all levels by
default.</p></li>
<li><p><strong>drop</strong> (<em>bool, default False</em>) – Do not try to insert index into dataframe columns. This resets
the index to the default integer index.</p></li>
<li><p><strong>inplace</strong> (<em>bool, default False</em>) – Modify the DataFrame in place (do not create a new object).</p></li>
<li><p><strong>col_level</strong> (<em>int or str, default 0</em>) – If the columns have multiple levels, determines which level the
labels are inserted into. By default it is inserted into the first
level.</p></li>
<li><p><strong>col_fill</strong> (<em>object, default ‘’</em>) – If the columns have multiple levels, determines how the other
levels are named. If None then the index name is repeated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataFrame or None</em> – DataFrame with the new index or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.set_index()</span></code></dt><dd><p>Opposite of reset_index.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.reindex()</span></code></dt><dd><p>Change to new indices or expand indices.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.reindex_like()</span></code></dt><dd><p>Change to same indices as other DataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mf">389.0</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="mf">80.5</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;parrot&#39;</span><span class="p">,</span> <span class="s1">&#39;lion&#39;</span><span class="p">,</span> <span class="s1">&#39;monkey&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;max_speed&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">         class  max_speed</span>
<span class="go">falcon    bird      389.0</span>
<span class="go">parrot    bird       24.0</span>
<span class="go">lion    mammal       80.5</span>
<span class="go">monkey  mammal        NaN</span>
</pre></div>
</div>
<p>When we reset the index, the old index is added as a column, and a
new sequential index is used:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="go">    index   class  max_speed</span>
<span class="go">0  falcon    bird      389.0</span>
<span class="go">1  parrot    bird       24.0</span>
<span class="go">2    lion  mammal       80.5</span>
<span class="go">3  monkey  mammal        NaN</span>
</pre></div>
</div>
<p>We can use the <cite>drop</cite> parameter to avoid the old index being added as
a column:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    class  max_speed</span>
<span class="go">0    bird      389.0</span>
<span class="go">1    bird       24.0</span>
<span class="go">2  mammal       80.5</span>
<span class="go">3  mammal        NaN</span>
</pre></div>
</div>
<p>You can also use <cite>reset_index</cite> with <cite>MultiIndex</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                   <span class="p">(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;parrot&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="s1">&#39;lion&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="s1">&#39;monkey&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                                  <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                     <span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mf">389.0</span><span class="p">,</span> <span class="s1">&#39;fly&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span> <span class="mf">24.0</span><span class="p">,</span> <span class="s1">&#39;fly&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span> <span class="mf">80.5</span><span class="p">,</span> <span class="s1">&#39;run&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;jump&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">               speed species</span>
<span class="go">                 max    type</span>
<span class="go">class  name</span>
<span class="go">bird   falcon  389.0     fly</span>
<span class="go">       parrot   24.0     fly</span>
<span class="go">mammal lion     80.5     run</span>
<span class="go">       monkey    NaN    jump</span>
</pre></div>
</div>
<p>If the index has multiple levels, we can reset a subset of them:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
<span class="go">         class  speed species</span>
<span class="go">                  max    type</span>
<span class="go">name</span>
<span class="go">falcon    bird  389.0     fly</span>
<span class="go">parrot    bird   24.0     fly</span>
<span class="go">lion    mammal   80.5     run</span>
<span class="go">monkey  mammal    NaN    jump</span>
</pre></div>
</div>
<p>If we are not dropping the index, by default, it is placed in the top
level. We can place it in another level:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">col_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">                speed species</span>
<span class="go">         class    max    type</span>
<span class="go">name</span>
<span class="go">falcon    bird  389.0     fly</span>
<span class="go">parrot    bird   24.0     fly</span>
<span class="go">lion    mammal   80.5     run</span>
<span class="go">monkey  mammal    NaN    jump</span>
</pre></div>
</div>
<p>When the index is inserted under another level, we can specify under
which one with the parameter <cite>col_fill</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">col_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_fill</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="go">              species  speed species</span>
<span class="go">                class    max    type</span>
<span class="go">name</span>
<span class="go">falcon           bird  389.0     fly</span>
<span class="go">parrot           bird   24.0     fly</span>
<span class="go">lion           mammal   80.5     run</span>
<span class="go">monkey         mammal    NaN    jump</span>
</pre></div>
</div>
<p>If we specify a nonexistent level for <cite>col_fill</cite>, it is created:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">col_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_fill</span><span class="o">=</span><span class="s1">&#39;genus&#39;</span><span class="p">)</span>
<span class="go">                genus  speed species</span>
<span class="go">                class    max    type</span>
<span class="go">name</span>
<span class="go">falcon           bird  389.0     fly</span>
<span class="go">parrot           bird   24.0     fly</span>
<span class="go">lion           mammal   80.5     run</span>
<span class="go">monkey         mammal    NaN    jump</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.set_index">
<code class="sig-name descname">set_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">keys</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L104-L110"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.set_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the DataFrame index using existing columns.</p>
<p>Set the DataFrame index (row labels) using one or more existing
columns or arrays (of the correct length). The index can replace the
existing index or expand on it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>label or array-like or list of labels/arrays</em>) – This parameter can be either a single column key, a single array of
the same length as the calling DataFrame, or a list containing an
arbitrary combination of column keys and arrays. Here, “array”
encompasses <code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code>, <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, and
instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code>.</p></li>
<li><p><strong>drop</strong> (<em>bool, default True</em>) – Delete columns to be used as the new index.</p></li>
<li><p><strong>append</strong> (<em>bool, default False</em>) – Whether to append columns to existing index.</p></li>
<li><p><strong>inplace</strong> (<em>bool, default False</em>) – Modify the DataFrame in place (do not create a new object).</p></li>
<li><p><strong>verify_integrity</strong> (<em>bool, default False</em>) – Check the new index for duplicates. Otherwise defer the check until
necessary. Setting to False will improve the performance of this
method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataFrame</em> – Changed row labels.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.reset_index()</span></code></dt><dd><p>Opposite of set_index.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.reindex()</span></code></dt><dd><p>Change to new indices or expand indices.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.reindex_like()</span></code></dt><dd><p>Change to same indices as other DataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;sale&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">31</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   month  year  sale</span>
<span class="go">0      1  2012    55</span>
<span class="go">1      4  2014    40</span>
<span class="go">2      7  2013    84</span>
<span class="go">3     10  2014    31</span>
</pre></div>
</div>
<p>Set the index to become the ‘month’ column:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
<span class="go">       year  sale</span>
<span class="go">month</span>
<span class="go">1      2012    55</span>
<span class="go">4      2014    40</span>
<span class="go">7      2013    84</span>
<span class="go">10     2014    31</span>
</pre></div>
</div>
<p>Create a MultiIndex using columns ‘year’ and ‘month’:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">])</span>
<span class="go">            sale</span>
<span class="go">year  month</span>
<span class="go">2012  1     55</span>
<span class="go">2014  4     40</span>
<span class="go">2013  7     84</span>
<span class="go">2014  10    31</span>
</pre></div>
</div>
<p>Create a MultiIndex using an Index and a column:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="s1">&#39;year&#39;</span><span class="p">])</span>
<span class="go">         month  sale</span>
<span class="go">   year</span>
<span class="go">1  2012  1      55</span>
<span class="go">2  2014  4      40</span>
<span class="go">3  2013  7      84</span>
<span class="go">4  2014  10     31</span>
</pre></div>
</div>
<p>Create a MultiIndex using two Series:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>
<span class="go">      month  year  sale</span>
<span class="go">1 1       1  2012    55</span>
<span class="go">2 4       4  2014    40</span>
<span class="go">3 9       7  2013    84</span>
<span class="go">4 16     10  2014    31</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.spacegroup">
<em class="property">property </em><code class="sig-name descname">spacegroup</code><a class="headerlink" href="#reciprocalspaceship.DataSet.spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Crystallographic space group</p>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.stack_anomalous">
<code class="sig-name descname">stack_anomalous</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plus_labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">minus_labels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L359-L453"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.stack_anomalous" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert data from two-column anomalous format to one-column
format. Intensities, structure factor amplitudes, or other data
are converted from separate columns corresponding to a single
Miller index to the same data column at different rows indexed
by the Friedel-plus or Friedel-minus Miller index.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">True</span></code>, this method will return a DataSet
with twice as many rows as the original –  one row for each Friedel
pair. If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, this method will return a
DataSet with the same number of rows as the original.</p>
<p>For a merged DataSet, this has the effect of mapping reflections
from the positive reciprocal space ASU to the positive and negative
reciprocal space ASU, for Friedel-plus and Friedel-minus reflections,
respectively. For an unmerged DataSet, Bijvoet reflections are mapped
from the positive reciprocal space ASU to their observed Miller
indices.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>It is assumed that Friedel-plus column labels are suffixed with (+),
and that Friedel-minus column labels are suffixed with (-)</p></li>
<li><p>Corresponding column labels are expected to be given in the same order</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plus_labels</strong> (<em>str or list-like</em>) – Column label or list of column labels of data associated with
Friedel-plus reflection (Defaults to columns suffixed with “(+)”)</p></li>
<li><p><strong>minus_labels</strong> (<em>str or list-like</em>) – Column label or list of column labels of data associated with
Friedel-minus reflection (Defaults to columns suffixed with “(-)”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="reciprocalspaceship.DataSet.unstack_anomalous"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.unstack_anomalous()</span></code></a></dt><dd><p>Opposite of stack_anomalous</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.to_gemmi">
<code class="sig-name descname">to_gemmi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">skip_problem_mtztypes</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L160-L182"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_gemmi" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates gemmi.Mtz object from DataSet object.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dataset.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the reflections will be mapped to the
reciprocal space ASU, and a M/ISYM column will be constructed.</p>
<p>If boolean flags with the label <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code> or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code> are found
in the DataSet, these will be cast to the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype, and included
in the gemmi.Mtz object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>skip_problem_mtztypes</strong> (<em>bool</em>) – Whether to skip columns in DataSet that do not have specified
MTZ datatypes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>gemmi.Mtz</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.unstack_anomalous">
<code class="sig-name descname">unstack_anomalous</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">columns</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">suffixes</span><span class="o">=</span><span class="default_value">'(+)', '(-)'</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L455-L536"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert data from one-column format to two-column anomalous
format. Provided column labels are converted from separate rows
indexed by their Friedel-plus or Friedel-minus Miller index to
different columns indexed at the Friedel-plus HKL.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">True</span></code>, this method will return a DataSet
with half as many rows as the original –  one row with both Friedel
pairs. If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, this method will return a
DataSet with the same number of rows as the original.</p>
<p>For a merged DataSet, this has the effect of mapping reflections
to the positive reciprocal space ASU, including data for both Friedel
pairs at the Friedel-plus Miller index. For an unmerged DataSet,
all Bijvoet reflections are mapped to the Miller index of the positive
reciprocal space ASU; however, the reflection data is kept in distinct
rows with the anomalous data in columns suffixed according to whether
the underlying reflection is Friedel-plus or Friedel-minus. A M/ISYM
column is added to an unmerged DataSet to allow reflections to be
mapped back to their observed Miller index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> (<em>str or list-like</em>) – Column label or list of column labels of data that should be
associated with Friedel pairs. If None, all columns are
converted are converted to the two-column anomalous format.</p></li>
<li><p><strong>suffixes</strong> (<em>tuple or list  of str</em>) – Suffixes to append to Friedel-plus and Friedel-minus data
columns</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.stack_anomalous" title="reciprocalspaceship.DataSet.stack_anomalous"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.stack_anomalous()</span></code></a></dt><dd><p>Opposite of unstack_anomalous</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="reciprocalspaceship.DataSet.write_mtz">
<code class="sig-name descname">write_mtz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mtzfile</span></em>, <em class="sig-param"><span class="n">skip_problem_mtztypes</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/master/reciprocalspaceship/dataset.py#L184-L204"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.write_mtz" title="Permalink to this definition">¶</a></dt>
<dd><p>Write DataSet to MTZ file.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the reflections will be mapped to the
reciprocal space ASU, and a M/ISYM column will be constructed.</p>
<p>If boolean flags with the label <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code> or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code> are found
in the DataSet, these will be cast to the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype, and included
in the output MTZ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mtzfile</strong> (<em>str or file</em>) – name of an mtz file or a file object</p></li>
<li><p><strong>skip_problem_mtztypes</strong> (<em>bool</em>) – Whether to skip columns in DataSet that do not have specified
MTZ datatypes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reciprocalspaceship.DataSeries.html" class="btn btn-neutral float-right" title="DataSeries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jack B. Greisman, Kevin M. Dalton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>